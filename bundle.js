(()=>{"use strict";class t{static projectName="BetterOnlineQuestBook";static projectName_zh="更好的在线任务书";static projectNm="BOQB";static projectDsc_zh="一时间想不起是哪个任务但又不方便开游戏?试试这个,更好的在线任务书!";static projectDsc="A convenient online quest book when you can't remember which quest to play!";static projectVersion="1.0.3";static projectDescription="BetterOnlineQuestBook";static projectAuthor=["MCTBL","Grievous_Rain"];static versionList=["2.8.0","2.7.2","Tutorials 1.0","Tutorials 1.0"];static resList=["280","272","tutorials","tutorials"];static questLinePath="quest_line.json";static questDataPath="quest_json";static projectUrl="https://github.com/MCTBL/Better_Online_QuestBook";static atlasPath="quests_icons.json"}var e,s;window.ProjectConfig=t,function(t){t.selectVersionIndex="selectVersionIndex",t.selectBtnIndex="selectBtnIndex",t.language="language"}(e||(e={})),function(t){t.zh="zh",t.en="en"}(s||(s={}));class a{static language=s.zh;static urlParameter;static basicUrl;static isPhone=!1;static selectVersionIndex=0;static getPath(t){return"version/"+this.getVersion()+"/"+t}static getVersion(){return t.resList[a.selectVersionIndex]}static getQuestLinePath(){return this.getPath(t.questLinePath)}static getQuestDataPath(e){var a=this.getPath(t.questDataPath);return e==s.en&&(a+="_en"),a+".json"}static fakeQuest={name:0,symbolSize:0,symbol:"",x:0,y:0,select:{disabled:!0},tooltip:{show:!1}};static echartsConfig={backgroundColor:"#f5f0d3",animation:!0,animationThreshold:2e3,animationDuration:1e3,animationEasing:"cubicOut",animationDelay:0,animationDurationUpdate:300,animationEasingUpdate:"cubicOut",animationDelayUpdate:0,aria:{enabled:!1},color:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"],series:[{type:"graph",layout:"none",symbolSize:10,circular:{rotateLabel:!1},force:{repulsion:0,gravity:0,edgeLength:30,friction:.6,layoutAnimation:!0},label:{show:!1,position:"up",margin:8,valueAnimation:!1},lineStyle:{show:!0,width:1,opacity:1,curveness:0,type:"solid"},roam:!0,draggable:!1,focusNodeAdjacency:!0,data:null,edgeLabel:{show:!1,margin:8,valueAnimation:!1},edgeSymbol:["circle","arrow"],edgeSymbolSize:10,links:null,emphasis:{disabled:!0,scale:1,focus:"None"}}],legend:[{data:[],selected:{}}],tooltip:{trigger:"item",triggerOn:"mousemove|click",axisPointer:{type:"line"},showContent:!0,alwaysShowContent:!1,showDelay:0,hideDelay:100,enterable:!1,confine:!1,appendToBody:!1,transitionDuration:.4,textStyle:{fontSize:14},borderWidth:0,padding:5,order:"seriesAsc"}};static infoQuest=[{title:`§9§l${t.projectName}§r`,name:"",symbolSize:0,symbol:"logo.png",x:0,y:0,data:`§c§l${t.projectDsc}§r<br/><br/>§lAuthor:§r §9§l<a class="githubLink" href="https://github.com/MCTBL" target="_blank">${t.projectAuthor[0]}</a>§r、 §3§l<a class="githubLink" href="https://github.com/NoRainLand" target="_blank">${t.projectAuthor[1]}</a>§r<br/><br/>§lProject Address: [url]${t.projectUrl}[/url]§r<br/>- If you have any questions or needs, please go to the repository to submit an issue.<br/><br/>The icon in the upper right corner can switch languages, the lower left corner can turn the taskbar on and off, and the upper left corner is the search bar.<br/><br/>The §lscroll wheel§r can zoom in and out of the chart, and the §lleft mouse button§r can also drag.<br/><br/>§lShortcut keys:§r<br/>§lR§r - Reset the chart<br/>§lH§r - Quickly open/hide quest line sidebar<br/>§lESC / E§r - Exit task details, or simply click on the black area outside the task box.<br/>`,quest_id:"",tooltip:"",is_main:0},{title:`§9§l${t.projectName_zh}§r`,name:"",symbolSize:0,symbol:"logo.png",x:0,y:0,data:`<br/>§c§l${t.projectDsc_zh}§r<br/><br/>§l作者:§r §9§l<a class="githubLink" href="https://github.com/MCTBL" target="_blank">${t.projectAuthor[0]}</a>§r、 §3§l<a class="githubLink" href="https://github.com/NoRainLand" target="_blank">${t.projectAuthor[1]}</a>§r<br/><br/>§l项目地址: [url]${t.projectUrl}[/url]§r<br/>- 有任何问题或需求前往仓库提交issue即可<br/><br/><br/><br/>§l滚轮§r可对图表进行缩放，§l左键§r可拖动<br/><br/>§l快捷键：§r<br/>§lR§r - 重置图表<br/>§lH§r - 快速开启/隐藏任务线侧边栏<br/>§lESC / E§r - 退出任务详情，或直接点击任务框外侧黑色区域即可<br/><br/>`,quest_id:"",tooltip:"",is_main:0}]}class i{static tipsTimer=0;static showTips(t){const e=(t.match(/[\u4e00-\u9fa5]/g)||[]).length,s=30*e+15*(t.length-e)+40;$("#tips").text(t),$("#tips").css("width",s+"px"),$("#tips").css("display","flex"),$("#tips").css("bottom","-70px"),$("#tips").animate({bottom:"0px"},500),this.tipsTimer&&(clearTimeout(this.tipsTimer),this.tipsTimer=0),this.tipsTimer=setTimeout(()=>{$("#tips").animate({bottom:"-70px"},500),$("#tips").css("display","none")},2e3)}static showLoading(){$("#loadingMask").show()}static hideLoading(){$("#loadingMask").hide()}}class n{static _instance;static get instance(){return this._instance??(this._instance=new n)}path2Atlas={};path2Base64={};atlasLoadingQueue={};loadedConfigPaths=new Set;useJson=!1;useAtlas=!0;useWebp=!0;init(t){this.useAtlas?this.loadConfig(t):t?.()}_supportAvif=-1;supportAvif(){if(-1==this._supportAvif)try{0===document.createElement("canvas").toDataURL("image/avif").indexOf("data:image/avif")?this._supportAvif=1:this._supportAvif=0}catch{this._supportAvif=0}return 1==this._supportAvif}loadConfig(e){let s=t.atlasPath;s=a.getPath(s),this.loadedConfigPaths.has(s)?e?.():fetch(s).then(t=>t.json()).then(t=>{this.loadedConfigPaths.add(s),this.parseAtlasConfig(t,s),e?.()}).catch(t=>{console.error("图集配置加载失败",t),i.showTips("图集配置加载失败"),e?.()})}parseAtlasConfig(t,e){const s=e.substring(0,e.lastIndexOf("."));for(const e in t){let a=t[e];const i=`${s}/${e}${this.useJson?".json":".gtbl"}`;for(let t of a){let a=`${s}/${e}/${t}`;this.path2Atlas[a]=i}}}setBase64(t,e){this.path2Base64[t]=e}setImgSrc(t,e){if(this.useAtlas)if(this.path2Base64[e])t.src=this.path2Base64[e];else if(this.path2Atlas[e]){const s=this.path2Atlas[e];this.atlasLoadingQueue[s]||(this.atlasLoadingQueue[s]=[],this.loadAtlas(s)),this.atlasLoadingQueue[s].push({img:t,path:e})}else t.src=e;else t.src=e}loadAtlas(t){fetch(t).then(t=>this.useJson?t.json():t.arrayBuffer()).then(e=>{if(this.useJson)this.addBase64(e,t);else{const s=pako.ungzip(new Uint8Array(e),{to:"string"});"string"==typeof s&&this.addBase64(JSON.parse(s),t)}})}addBase64(t,e){const s=e.substring(0,e.lastIndexOf("."));for(const e in t){let a=this.useWebp?`data:image/webp;base64,${t[e]}`:`data:image/png;base64,${t[e]}`;this.path2Base64[`${s}/${e.split(".")[0]}`]=a}this.callbackImg(e)}callbackImg(t){const e=this.atlasLoadingQueue[t];if(delete this.atlasLoadingQueue[t],e&&e.length)for(const t of e)this.path2Base64[t.path]?t.img.src=this.path2Base64[t.path]:(t.img.src=t.path,console.warn("图集加载失败",t.path))}}window.atlasMgr=n.instance;class o{static showEegg(){}}class r{static typingInterval=null;static processBase64ToDecimal(t){const e=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),s=atob(e),a=new Uint8Array(s.length);for(let t=0;t<s.length;t++)a[t]=s.charCodeAt(t);const i=Array.from(a,t=>t.toString(16).padStart(2,"0")).join("").slice(-16),n=BigInt("0x"+i);return String(n>>63n?n-(1n<<64n):n)}static processUrlParameters(t){let e=new Map;for(var s of t.searchParams.keys())e.set(s,t.searchParams.get(s));return e}static typeText(t,e,s=50){const a=$(t);a.text("");let i=0;null!==this.typingInterval&&clearInterval(this.typingInterval),this.typingInterval=setInterval(()=>{i<e.length?(a.append(e.charAt(i)),i++):(isNaN(Number(this.typingInterval))||clearInterval(Number(this.typingInterval)),this.typingInterval=null)},s)}static copyH5Str(t){var e=t+"";const s=document.createElement("textarea");s.value=e,s.setAttribute("readonly",""),s.style.position="absolute",s.style.left="-9999px",s.style.fontSize="12pt";const a=getSelection();var i;a.rangeCount>0&&(i=a.getRangeAt(0)),document.body.appendChild(s),s.select(),s.selectionStart=0,s.selectionEnd=e.length;try{document.execCommand("copy")}catch(t){}document.body.removeChild(s),i&&(a.removeAllRanges(),a.addRange(i))}static encodeMsg2AHref(t){return t.replace(/\[url\](https?:\/\/[^\s\[\]]+)\[\/url\]/g,'<a href="$1" target="_blank">$1</a>')}static expMCcolor(t){if(!t.includes("§"))return t;var e=/([^§]+)/g;if(null==t.match(e))return console.error("正则匹配失败"),t;for(var s=document.createElement("span"),a=t.match(e).length,i="#000000",n="normal",o="none",r="normal",l=0;l<a;l++){var c=t.match(e)[l],h=c.substring(0,1),u=document.createElement("quest_desc"),p=this.functioncolor(h);"#"==p.substring(0,1)?(i=p,o="none",r="normal",n="normal"):"bold"==p?n=p:"line-through"==p||"underline"==p?(o=p,n="normal"):"italic"==p?r=p:"none"==p&&(i="#000000",n="normal",o="none",r="normal");var g=c.substr("unknown style"==p?0:1);0!=g.length&&(u.style.color=i,u.style.fontWeight=n,u.style.textDecoration=o,u.style.fontStyle=r,u.innerHTML=g,s.append(u))}return s.innerHTML}static functioncolor(t){return"a"==t?"#50f050":"b"==t?"#4be0e0":"c"==t?"#ff5555":"d"==t?"#ff55ff":"e"==t?"#bebe00":"f"==t?"#ffffff":"g"==t?"#ddd605":"0"==t?"#000000":"1"==t?"#0000aa":"2"==t?"#00aa00":"3"==t?"#00aaaa":"4"==t?"#aa0000":"5"==t?"#aa00aa":"6"==t?"#ffaa00":"7"==t?"#aaaaaa":"8"==t?"#555555":"9"==t?"#5555ff":"k"==t?"Random":"l"==t?"bold":"m"==t?"line-through":"n"==t?"underline":"o"==t?"italic":"r"==t?"none":"unknown style"}static deepClone(t){const e=new l;function s(t){return"object"==typeof t&&t||"function"==typeof t}return function t(a){if(!s(a))return a;if(-1!==[Date,RegExp].indexOf(a.constructor))return new a.constructor(a);if("function"==typeof a)return"not support";const i=e.get(a);if(i)return i;if(Array.isArray(a)){let e=[];for(let s=0;s<a.length;s++)e.push(t(a[s]));return e}if(a instanceof Map){const i=new Map;return e.set(a,i),a.forEach((e,a)=>{s(e)?i.set(a,t(e)):i.set(a,e)}),i}if(a instanceof Set){const i=new Set;return e.set(a,i),a.forEach(e=>{s(e)?i.add(t(e)):i.add(e)}),i}const n=Reflect.ownKeys(a);var o={};Object.keys(a).forEach(function(t){o[t]=Object.getOwnPropertyDescriptor(a,t)});const r=Object.create(Object.getPrototypeOf(a),o);return e.set(a,r),n.forEach(e=>{const i=a[e];s(i)?r[e]=t(i):r[e]=i}),r}(t)}static removeHTMLTags(t){let e=t.replace(/<br\s*\/?>/gi,"\n");return e=e.replace(/<a\s+[^>]*?href=["']([^"']*)["'][^>]*?>([^<]*?)<\/a>/gi,(t,e,s)=>`${e}`),e=e.replace(/<[^>]*>/g,""),e}static shuffle(t){for(let e=t.length-1;e>0;e--){const s=Math.floor(Math.random()*(e+1));[t[e],t[s]]=[t[s],t[e]]}return t}}class l{_keys;_values;constructor(){this._keys=[],this._values=[]}set(t,e){const s=this._keys.indexOf(t);-1===s?(this._keys.push(t),this._values.push(e)):this._values[s]=e}get(t){const e=this._keys.indexOf(t);return-1===e?void 0:this._values[e]}has(t){return-1!==this._keys.indexOf(t)}delete(t){const e=this._keys.indexOf(t);return-1!==e&&(this._keys.splice(e,1),this._values.splice(e,1),!0)}}class c{static nowTitle="";static nowDesc="";static nowID="";static nowLogo="";static onCopyDesc=()=>{r.copyH5Str(r.removeHTMLTags(`${this.nowTitle}\n${this.nowDesc}`)),i.showTips(a.language==s.zh?"复制成功":"Copy Success")};static onCopyId=()=>{r.copyH5Str(this.nowID),i.showTips(a.language==s.zh?"复制成功":"Copy Success")};static onCopyLink=()=>{r.copyH5Str(a.basicUrl+"?id="+this.nowID),i.showTips(a.language==s.zh?"复制成功":"Copy Success")};static showPopup(t){this.nowTitle=r.expMCcolor(t.title),this.nowDesc=this.processDesc(r.expMCcolor(t.data)),this.nowID=t.quest_id,this.nowLogo=t.symbol.replace("image://",""),$("#quest_id").text(this.nowID),$("#popTitle").html(this.nowTitle),$("#popDesc").html(this.nowDesc);let e=$("#quest_logo")[0];n.instance.setImgSrc(e,this.nowLogo),$("#mainPage").focus(),removeEventListener("keydown",this.onKeyDown),addEventListener("keydown",this.onKeyDown),$("#overlay").off("click"),$("#overlay").on("click",this.hidePopup),$("#popup").off("click"),$("#popup").on("click",this.onClickPop),$("#copyBtn").off("click"),$("#copyBtn").on("click",this.onCopyDesc),$("#copyBtn").css("display","block"),$("#copyIdBtn").off("click"),$("#copyIdBtn").on("click",this.onCopyId),$("#copyIdBtn").css("display","block"),$("#copyLinkBtn").off("click"),$("#copyLinkBtn").on("click",this.onCopyLink),$("#copyLinkBtn").css("display","block"),$("#copyBtn").text(a.language==s.zh?"复制任务详情":"Copy Desc"),$("#copyIdBtn").text(a.language==s.zh?"复制任务ID":"Copy ID"),$("#copyLinkBtn").text(a.language==s.zh?"复制任务链接":"Copy Link"),$("btnClosePop").off("click"),$("#btnClosePop").on("click",this.hidePopup),$("#screenShot").off("click"),$("#screenShot").on("click",this.screenShot),$("#popup").css("scale",.8),$("#overlay").css("display","flex"),$("#popup").animate({scale:1},200)}static showInfoPopup(){this.showPopup(a.language.includes("zh")?a.infoQuest[1]:a.infoQuest[0]),$("#copyBtn").css("display","none"),$("#copyIdBtn").css("display","none"),$("#copyLinkBtn").css("display","none")}static processDesc(t){let e=t.split(/\[\/?url\]/),s="";for(let t=0;t<e.length;t++)if(void 0!==e[t])if(t%2==1&&e[t].trim().length>0){let a=e[t];a.startsWith("http://")||a.startsWith("https://")?s+=`<a href="${a}" target="_blank">${a}</a>`:s+=`<a href="http://${a}" target="_blank">${a}</a>`}else s+=e[t];e=s.split(/\[\/?note\]/),s="";for(let t=0;t<e.length;t++)void 0!==e[t]&&(t%2==1&&e[t].trim().length>0?s+=`<note style='color:#00AAAA'>${e[t]}</note>`:s+=e[t]);e=s.split(/\[\/?warn\]/),s="";for(let t=0;t<e.length;t++)void 0!==e[t]&&(t%2==1&&e[t].trim().length>0?s+=`<warn style='color:#AA0000'>${e[t]}</warn>`:s+=e[t]);return s}static hidePopup=()=>{$("#overlay").css("display","none")};static onClickPop=t=>{t.stopPropagation()};static screenShot(){}static onKeyDown=t=>{"Escape"!=t.key&&"e"!=t.key||c.hidePopup()}}class h{static echarts;static pageData;static questList;static resetChart(){this.echarts?.clear(),this.echarts?.resize(),this.echarts?.setOption(this.pageData)}static getPageData(t){a.isPhone?this.showSearchPopup(t.data.data):(r.typeText("#questTitle",t.title),this.pageData=r.deepClone(a.echartsConfig),this.pageData.series[0].data=t.data.data,this.pageData.series[0].links=t.data.links,this.initEcharts())}static initEcharts(){if(!this.echarts){this.echarts=echarts.init(document.getElementById("this_chart"),"white",{renderer:"canvas"}),this.echarts.on("click",t=>{if("node"===t.dataType)if(t.data.hasOwnProperty("parentSymbol")){let e=r.deepClone(t.data);e.symbol=e.parentSymbol,c.showPopup(e)}else t.data.hasOwnProperty("quest_id")&&c.showPopup(t.data)});const t=$("#mainPage")[0];new ResizeObserver(()=>{this.onResize()}).observe(t)}this.resetChart()}static onResize(){this.echarts?.resize()}static showSearchPopup(t){$("#questSearchList").empty(),t&&t.length&&(this.questList=t,this.showSearchList(),$("#searchPopup").show())}static clearSearchList(){$("#questSearchList").empty(),$("#searchPopup").hide()}static toTop(){$("#questSearchList").animate({scrollTop:0},500)}static showSearchList(){this.questList&&this.questList.length&&this.questList.forEach(t=>{if(t&&null==t.parentSymbol){const e=$(`\n\t\t\t\t\t\t<div class="searchItem" data-id="${t.quest_id}">\n\t\t\t\t\t\t\t<img class="searchImg" />\n\t\t\t\t\t\t\t<div class="searchTitle">${r.expMCcolor(t.title)}</div>\n\t\t\t\t\t\t\t<div class="searchDesc">${r.expMCcolor(t.data.substring(0,50))}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`),s=e.find(".searchImg")[0];n.instance.setImgSrc(s,t.symbol.replace("image://","")),e.off("click"),e.on("click",()=>{c.showPopup(t)}),$("#questSearchList").append(e)}})}}class u{questLine=[];buttonList=[];isSidebarHide=!1;questAllData={};titleToQuest={};questIdToQuest={};oldQuestData=null;startX=0;startY=0;constructor(){$(()=>{i.showLoading();const t=new URL(window.location.href);a.urlParameter=r.processUrlParameters(t),a.basicUrl=t.origin,this.initVersion(),this.initPlatform(),this.initLang(),this.initPage(),this.addEvent(),this.showProjectMsg(),n.instance.init(()=>this.loadQuestLine()),o.showEegg()})}initPlatform(){a.isPhone=!!isMobile.phone}showProjectMsg(){setTimeout(()=>{console.log(`%c${t.projectName_zh}\n\n%c${t.projectDsc_zh}\n\n%c作者: ${t.projectAuthor}\n\n%c项目地址: ${t.projectUrl}`,"color:#252525; font-size: 30px;","color:#e12885; font-size: 18px;","color:#137a7f; font-size: 20px;","color:#525658; font-size: 16px;")},300)}initVersion(){a.selectVersionIndex=parseInt(localStorage.getItem(e.selectVersionIndex)||"0")}initPage(){for(let e=0;e<t.versionList.length;e++){let s=$("<option>",{text:t.versionList[e],value:t.versionList[e]});$("#versionSelect").append(s)}$("#versionSelect").val(t.versionList[a.selectVersionIndex])}initLang(){const t=localStorage.getItem(e.language);a.language=t?t===s.zh?s.zh:s.en:navigator.language.includes("zh")?s.zh:s.en,this.initTitle()}initTitle(){a.language==s.zh?document.title=t.projectName_zh:document.title=t.projectName}addEvent(){$("#toggleSidebar").on("click",this.toggleSidebar),addEventListener("keydown",this.onKeyDown),addEventListener("touchstart",t=>{this.startX=t.touches[0].pageX,this.startY=t.touches[0].pageY}),addEventListener("touchend",this.whenRightSlide),$("#logoImg").on("click",this.onClickLogo),$("#logoImg").on("contextmenu",this.onRightClickLogo),$("#search").on("focus",this.onSearchFocus),$("#search").on("blur",this.onSearchBlur),$("#search").on("input",this.onSeachInput),$("#btnCloseSp").on("click",this.onClosePop),$("#changeLang").on("click",this.onChangeLang),$("#btnShowMsg").on("click",this.onClickInfo),$("#btnTop").on("click",this.onClickTop),$("#versionSelect").on("change",t=>{a.selectVersionIndex!=t.target.selectedIndex&&(a.selectVersionIndex=t.target.selectedIndex,localStorage.setItem(e.selectVersionIndex,a.selectVersionIndex.toString()),location.reload())})}loadQuestLine(){$.getJSON(a.getQuestLinePath(),t=>{this.questLine=t,this.questLine.forEach((t,e)=>{let s=this.createButton(e,t);$("#questLineList").append(s),this.buttonList.push(s)}),this.loadQuestData()})}loadQuestData(){this.questAllData&&null!=this.questAllData[a.language]?this.initQuestList():$.getJSON(a.getQuestDataPath(a.language),t=>{let e=a.getVersion();this.questAllData[a.language]=t;let s=this.questAllData[a.language],i={},n={};for(let t in s){let a=s[t].data,o=[];if(a)for(let s=0;s<a.length;s++){let l=a[s];l.symbol="image://version/"+e+"/quests_icons/QuestIcon/"+t+"/"+r.processBase64ToDecimal(l.quest_id),i[l.title]=l,n[l.quest_id]=l;let c=r.deepClone(l);c.name=String(s),c.symbolSize=Math.ceil(1.3*l.symbolSize),c.parentSymbol=l.symbol,c.symbol="image://static/"+(1==l.is_main?"main":"not_main")+".png",o.push(c)}s[t].data=o.concat(s[t].data)}this.titleToQuest[a.language]=i,this.questIdToQuest[a.language]=n,this.initQuestList()})}createButton(t,i){const o=$("<button>",{id:`btnQuest_${t}`,class:"questButton unselected",click:t=>{this.buttonList.forEach((s,a)=>{s[0]===t.currentTarget?(localStorage.setItem(e.selectBtnIndex,a.toString()),s.removeClass("unselected").addClass("selected")):s.removeClass("selected").addClass("unselected")});const n={title:a.language===s.zh?i.title_zh:i.title,data:this.questAllData[a.language][i.quest]};h.getPageData(n),this.oldQuestData=r.deepClone(n),a.isPhone||this.onClosePop(),a.isPhone&&this.toggleSidebar()}});o.data("questData",i);const l=$("<img>",{class:"questIcon"});n.instance.setImgSrc(l[0],a.getPath(`quests_icons/QuestLineIcon/${i.quest}`));const c=$("<span>",{text:a.language===s.zh?i.title_zh:i.title,class:"questText"});return o.append(l,c),o}initQuestList(){$("#search").val(""),$("#search").attr("placeholder",a.language==s.zh?"搜索任务":"Search Quest");let t,n=localStorage.getItem(e.selectBtnIndex);if(t=n&&this.buttonList&&this.buttonList.length?this.buttonList[parseInt(n)]:this.buttonList[0],t?.removeClass("unselected").addClass("selected"),this.buttonList.length)for(let t=0;t<this.buttonList.length;t++){let e=this.buttonList[t],i=e.data("questData"),n=a.language==s.zh?i.title_zh:i.title;e.find(".questText").text(n)}let o=t.data("questData"),l=this.questAllData[a.language][o.quest];if(l){let t={title:a.language==s.zh?o.title_zh:o.title,data:l};h.getPageData(t),this.oldQuestData=r.deepClone(t),i.hideLoading(),this.checkHasQuestIdInParameters()}else console.error("任务数据异常"),i.showTips("任务数据异常")}checkHasQuestIdInParameters(){if(a.urlParameter.has("id")){var t=a.urlParameter.get("id");t in this.questIdToQuest[a.language]?c.showPopup(this.questIdToQuest[a.language][t]):(console.error("任务id有误"),i.showTips("任务id有误"))}}onKeyDown=t=>{"r"==t.key?h.resetChart():"h"==t.key&&this.toggleSidebar()};onClickLogo=()=>{};onRightClickLogo=t=>{t.preventDefault(),t.stopPropagation()};toggleSidebar=()=>{let t=$("#sidebar").width();$("#toggleSidebar").hide();let e=a.isPhone?250:500;if(setTimeout(()=>{$("#toggleSidebar").show()},e),this.isSidebarHide){if($("#sidebar").animate({left:"0px"},e),!a.isPhone){let s=$(window).width()-t;$("#mainPage").animate({left:`${t}px`,width:s+"px"},e)}this.isSidebarHide=!1}else $("#sidebar").animate({left:`-${t}px`},e),a.isPhone||$("#mainPage").animate({left:"0px",width:"100%"},e),this.isSidebarHide=!0};onSearchFocus=()=>{};onSeachInput=()=>{const t=$("#search").val()?.toString().trim();if(t){"none"===$("#btnCloseSp").css("display")&&$("#btnCloseSp").show().animate({opacity:1},500),a.isPhone&&$("#logoBg").animate({opacity:.4},500);const e=Object.values(this.titleToQuest[a.language]).filter(e=>e.title&&e.title.toLocaleUpperCase().includes(t.toLocaleUpperCase()));h.showSearchPopup(e)}else this.onClosePop()};onClosePop=()=>{$("#search").val(""),$("#btnCloseSp").hide(),$("#btnCloseSp").css("opacity",0),a.isPhone&&$("#logoBg").css("opacity",1),a.isPhone?h.getPageData(this.oldQuestData):h.clearSearchList()};onSearchBlur=()=>{};onChangeLang=()=>{i.showLoading(),a.language==s.zh?a.language=s.en:a.language=s.zh,localStorage.setItem(e.language,a.language),this.initTitle(),a.isPhone&&this.onClosePop(),this.loadQuestData()};onClickInfo(){c.showInfoPopup()}onClickTop=()=>{this.isSidebarHide?h.toTop():$("#sidebar").animate({scrollTop:0},500)};whenRightSlide=t=>{const e=t.changedTouches[0].clientX-this.startX,s=t.changedTouches[0].clientY-this.startY;Math.abs(s)<=10&&e>50&&this.isSidebarHide&&a.isPhone&&this.toggleSidebar()}}new class{constructor(){window.main=new u}}})();